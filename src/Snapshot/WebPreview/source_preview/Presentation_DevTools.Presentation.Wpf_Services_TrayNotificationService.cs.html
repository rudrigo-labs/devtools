<html><head><meta charset='UTF-8'>
<link rel='stylesheet' href='../prism-tomorrow.min.css'>
<style>
body { background: #1d1d1d; margin: 0; padding: 10px; font-size: 14px; }
pre { border-radius: 6px; }
</style>
</head><body>
<pre><code class='language-csharp'>using System;
using System.Linq;
using H.NotifyIcon;

namespace DevTools.Presentation.Wpf.Services;

internal sealed class TrayNotificationService
{
    private readonly TaskbarIcon _taskbarIcon;

    public TrayNotificationService(TaskbarIcon taskbarIcon)
    {
        _taskbarIcon = taskbarIcon;
    }

    public void UpdateTooltip(string text)
    {
        _taskbarIcon.ToolTipText = text;
    }

    public bool TryShowNotification(string title, string message, bool success)
    {
        try
        {
            var iconName = success ? &quot;Info&quot; : &quot;Error&quot;;
            var methods = _taskbarIcon.GetType()
                .GetMethods()
                .Where(m =&gt; m.Name == &quot;ShowNotification&quot; &amp;&amp; m.GetParameters().Length == 3)
                .ToArray();

            foreach (var method in methods)
            {
                var parameters = method.GetParameters();
                if (parameters[0].ParameterType != typeof(string) ||
                    parameters[1].ParameterType != typeof(string))
                {
                    continue;
                }

                if (!parameters[2].ParameterType.IsEnum)
                {
                    continue;
                }

                var iconValue = Enum.Parse(parameters[2].ParameterType, iconName, true);
                method.Invoke(_taskbarIcon, new[] { title, message, iconValue });
                return true;
            }
        }
        catch (Exception ex)
        {
            AppLogger.Error(&quot;Falha ao exibir notificacao no tray.&quot;, ex);
        }

        return false;
    }
}
</code></pre>
<script src='../prism.min.js'></script>
<script src='../prism-csharp.min.js'></script>
<script src='../prism-json.min.js'></script>
<script src='../prism-markdown.min.js'></script>
<script src='../prism-markup.min.js'></script>
<script src='../prism-powershell.min.js'></script>
<script src='../prism-yaml.min.js'></script>

</body></html>