<html><head><meta charset='UTF-8'>
<link rel='stylesheet' href='../prism-tomorrow.min.css'>
<style>
body { background: #1d1d1d; margin: 0; padding: 10px; font-size: 14px; }
pre { border-radius: 6px; }
</style>
</head><body>
<pre><code class='language-csharp'>using System;
using System.IO;
using System.Windows;
using System.Windows.Input;
using DevTools.Presentation.Wpf.Services;

namespace DevTools.Presentation.Wpf.Views;

public partial class LogsWindow : Window
{
    private readonly SettingsService _settingsService;

    public LogsWindow(SettingsService settingsService)
    {
        InitializeComponent();
        _settingsService = settingsService;
        
        Loaded += OnLoaded;
    }

    private void OnLoaded(object sender, RoutedEventArgs e)
    {
        RefreshLogs();
    }

    private void RefreshLogs()
    {
        try
        {
            if (File.Exists(AppLogger.LogFilePath))
            {
                // Read with file share to avoid locking issues if app is writing
                using var fs = new FileStream(AppLogger.LogFilePath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
                using var sr = new StreamReader(fs);
                LogTextBox.Text = sr.ReadToEnd();
                LogTextBox.ScrollToEnd();
            }
            else
            {
                LogTextBox.Text = &quot;Arquivo de log n&#227;o encontrado.&quot;;
            }
        }
        catch (Exception ex)
        {
            LogTextBox.Text = $&quot;Erro ao ler logs: {ex.Message}&quot;;
        }
    }

    private void Refresh_Click(object sender, RoutedEventArgs e)
    {
        RefreshLogs();
    }

    private void Clear_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            // Try to write empty
            File.WriteAllText(AppLogger.LogFilePath, string.Empty);
            RefreshLogs();
        }
        catch (Exception ex)
        {
            MessageBox.Show($&quot;N&#227;o foi poss&#237;vel limpar o arquivo de log: {ex.Message}&quot;, &quot;Erro&quot;, MessageBoxButton.OK, MessageBoxImage.Error);
        }
    }

    private void OpenFolder_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            var dir = Path.GetDirectoryName(AppLogger.LogFilePath);
            if (dir != null &amp;&amp; Directory.Exists(dir))
            {
                System.Diagnostics.Process.Start(new System.Diagnostics.ProcessStartInfo
                {
                    FileName = dir,
                    UseShellExecute = true
                });
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show($&quot;Erro ao abrir pasta: {ex.Message}&quot;, &quot;Erro&quot;, MessageBoxButton.OK, MessageBoxImage.Error);
        }
    }

    private void Header_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        DragMove();
    }

    private void CloseButton_Click(object sender, RoutedEventArgs e)
    {
        Close();
    }
}</code></pre>
<script src='../prism.min.js'></script>
<script src='../prism-csharp.min.js'></script>
<script src='../prism-json.min.js'></script>
<script src='../prism-markdown.min.js'></script>
<script src='../prism-markup.min.js'></script>
<script src='../prism-powershell.min.js'></script>
<script src='../prism-yaml.min.js'></script>

</body></html>